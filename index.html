<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>FloorballSzab√°lyok</title>

  <!-- App ikonok -->
  <link rel="icon" type="image/png" sizes="192x192" href="img/icon-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="img/icon-512.png" />

  <!-- Poppins bet≈±csal√°d -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet" />

  <!-- Phosphor ikonok -->
  <script defer src="https://unpkg.com/phosphor-icons"></script>

  <!-- Umami analitika ‚Äì IDE TEDD VISSZA A SAJ√ÅT ID-DET -->
  <!--
  <script async src="https://eu.umami.is/script.js"
          data-website-id="c1fb486e-d928-445e-986d-fa44cc181fae"></script>
  -->

  <!-- Firebase (v8) -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <!-- html2canvas a tan√∫s√≠tv√°nyhoz -->
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

  <!-- St√≠lusok -->
  <link rel="stylesheet" href="styles.css" />

  <!-- K√©rd√©sbank √©s app logika -->
  <script src="database.js" defer></script>
  <script src="app.js" defer></script>
</head>
<body>
  <div class="app-container">
    <!-- FEJL√âC / DASHBOARD -->
    <header class="dashboard-header">
      <div class="dashboard-nav">
        <button class="icon-btn" type="button" onclick="app.menu()" aria-label="F≈ëmen√º">
          <i class="ph-house"></i>
        </button>

        <div class="app-title" onclick="app.menu()">
          FloorballSzab√°lyok
        </div>

        <div class="header-actions">
          <button class="icon-btn" type="button" onclick="app.toggleTheme()" aria-label="T√©ma v√°lt√°sa">
            <i id="theme-icon" class="ph-moon"></i>
          </button>
          <button class="icon-btn" type="button" onclick="app.showRules()" aria-label="Szab√°lyk√∂nyv">
            <i class="ph-book-open"></i>
          </button>
          <button class="icon-btn" type="button" onclick="app.toggleInfo()" aria-label="Inf√≥ & GYIK">
            <i class="ph-info"></i>
          </button>
          <button class="icon-btn" type="button" onclick="app.toggleResetModal()" aria-label="Adatok t√∂rl√©se">
            <i class="ph-trash"></i>
          </button>
        </div>
      </div>

      <!-- Statisztik√°k -->
      <div class="dashboard-stats-container">
        <div class="stat-pill">
          <div class="stat-label">V√°laszok</div>
          <div class="stat-data">
            <span id="stat-answered">0</span>
            <span class="stat-sep">/</span>
            <span id="stat-total">0</span>
          </div>
        </div>

        <div class="stat-pill">
          <div class="stat-label">Streak</div>
          <div class="stat-data">
            <span id="stat-streak">0</span>
            <span>üî•</span>
          </div>
        </div>
      </div>

      <!-- P√°rbaj kih√≠v√°s CTA ‚Äì MINDIG A FEJL√âC ALATT -->
      <div class="dashboard-cta">
        <button
          type="button"
          class="btn-main btn-main--accent btn-main--compact"
          onclick="app.startChallengeMode()">
          ‚öîÔ∏è P√°rbaj kih√≠v√°s (b√©ta)
        </button>
      </div>
    </header>

    <!-- F≈ê TARTALOM -->
    <main class="content">
      <!-- F≈êMEN√ú ‚Äì T√âMA LISTA -->
      <section class="screen active" id="s-menu">
        <div class="section-header">
          <h2>T√©mak√∂r√∂k</h2>
          <span class="section-total-badge" id="total-badge">0%</span>
        </div>

        <div class="section-progress">
          <div class="progress-track">
            <div class="progress-fill" id="total-progress-fill"></div>
          </div>
        </div>

        <!-- Floorball Mester badge -->
        <div class="master-badge" id="master-info">
          <div class="master-icon">üèÜ</div>
          <div class="master-text">
            <strong>Floorball Mester!</strong> Minden t√©mak√∂rt v√©gigj√°tszott√°l ezen az eszk√∂z√∂n.
          </div>
        </div>

        <!-- T√©mak√°rty√°k -->
        <div class="topic-list" id="topic-container"></div>
      </section>

      <!-- SZINT V√ÅLASZT√ì -->
      <section class="screen" id="s-levels">
        <div class="section-header">
          <h2>V√°lassz szintet</h2>
        </div>
        <div class="level-title" id="lvl-title">T√©mak√∂r</div>
        <p class="level-subtitle">
          L1 = Kezd≈ë, L2 = Halad√≥, L3 = Profi. A magasabb szintek az el≈ëz≈ë szint teljes√≠t√©se ut√°n ny√≠lnak meg.
        </p>

        <div id="level-container"></div>
      </section>

      <!-- J√ÅT√âK K√âPERNY≈ê -->
      <section class="screen" id="s-game">
        <div class="game-header">
          <!-- √âletek -->
          <div id="g-lives" class="lives"></div>

          <!-- K√∂r / k√©rd√©s inf√≥k -->
          <div class="game-subtitle">
            <span id="q-label">
              H√°tral√©v≈ë k√©rd√©s:
              <span class="game-subtitle-number" id="q-remaining">0</span>
            </span>

            <span id="round-indicator" style="display:none; margin-left:8px;"></span>

            <span id="multi-badge"
                  style="display:none; margin-left:8px; font-size:0.75rem; font-weight:700; text-transform:uppercase;">
              P√°rbaj m√≥d
            </span>
          </div>

          <!-- Id≈ëz√≠t≈ë csak p√°rbaj m√≥dban -->
          <div class="timer-track" id="timer-bar" style="display:none;">
            <div class="timer-fill" id="timer-fill"></div>
          </div>

          <!-- Halad√°s a szinten bel√ºl -->
          <div class="game-progress">
            <div class="progress-track">
              <div class="progress-fill" id="g-prog"></div>
            </div>
          </div>
        </div>

        <!-- K√©rd√©s -->
        <div class="q-box">
          <div id="q-text"></div>
        </div>

        <!-- V√°lasz opci√≥k -->
        <div id="g-opts"></div>

        <!-- Feedback -->
        <div id="g-feed" class="feedback"></div>

        <div class="bottom-spacer"></div>
      </section>

      <!-- END / GAME OVER K√âPERNY≈ê -->
      <section class="screen screen-end" id="s-end">
        <div class="end-icon" id="end-icon">üéâ</div>
        <h1 class="end-title" id="end-title">K√∂r v√©ge</h1>
        <p class="end-msg" id="end-msg">Sz√©p munka! Csak √≠gy tov√°bb!</p>

        <div class="end-card">
          <div class="end-card-label">Eredm√©nyed</div>
          <div class="end-score" id="end-score">0/0</div>
        </div>

        <div class="end-actions" id="end-actions"></div>
      </section>

      <!-- SZAB√ÅLYK√ñNYV (PDF) -->
      <section class="screen screen-rules" id="s-rules">
        <div class="rules-header">
          <h2>Hivatalos szab√°lyk√∂nyv</h2>
        </div>

        <!-- Asztali n√©zet: be√°gyazott PDF -->
        <iframe
          class="pdf-desktop-view"
          src="Floorball_Jatekszabalyok_2022_FINAL.pdf"
          title="Floorball j√°t√©kszab√°lyok PDF"></iframe>

        <!-- Mobil n√©zet: gomb √∫j f√ºl√∂n ny√≠l√≥ PDF-hez -->
        <div class="pdf-mobile-view">
          <div class="pdf-deco-icon">üìò</div>
          <div class="pdf-title-mobile">Floorball j√°t√©kszab√°lyok (PDF)</div>
          <p>
            Mobilon a szab√°lyk√∂nyvet egy k√ºl√∂n PDF n√©zetben tudod k√©nyelmesen olvasni.
            Haszn√°ld a keres≈ët √©s a nagy√≠t√°st!
          </p>
          <a
            href="Floorball_Jatekszabalyok_2022_FINAL.pdf"
            target="_blank"
            rel="noopener"
            class="btn-pdf">
            Megnyit√°s PDF-ben
          </a>
        </div>
      </section>

      <!-- FLOORBALL MESTER K√âPERNY≈ê -->
      <section class="screen screen-master" id="s-master">
        <div id="certificate" class="certificate-box">
          <div class="certificate-icon">üèÜ</div>
          <h2 class="certificate-title">Floorball Mester</h2>
          <p class="certificate-text">
            Gratul√°lunk! V√©gigk√ºzd√∂tted magad az √∂sszes t√©mak√∂r√∂n ezen az eszk√∂z√∂n.
            Ezt a ‚Äûdiplom√°t‚Äù elmentheted √©s megoszthatod a csapatt√°rsaiddal.
          </p>
          <div class="certificate-badge">Hivatalos nem, men≈ë igen ü§ù</div>
        </div>

        <button class="btn-main" type="button" onclick="app.downloadCert()">
          Tan√∫s√≠tv√°ny let√∂lt√©se
        </button>
        <button class="btn-main btn-main--secondary" type="button" onclick="app.menu()">
          Vissza a f≈ëmen√ºbe
        </button>
      </section>
    </main>
  </div>

  <!-- PWA TELEP√çT√âS GOMB -->
  <button
    id="install-btn"
    type="button"
    class="btn-main btn-main--accent btn-main--compact"
    style="position: fixed; right: 16px; bottom: 16px; z-index: 1500; display: none;"
    onclick="app.triggerInstall()">
    + App hozz√°ad√°sa
  </button>

  <!-- WELCOME MODAL ‚Äì HUMOROS IND√çT√ì POPUP -->
  <div class="modal-overlay open" id="welcome-modal">
    <div class="modal-box modal-box-center">
      <span class="welcome-emoji">üèí</span>
      <h2 class="welcome-title">√údv a FloorballSzab√°lyok appban!</h2>
      <p class="welcome-text">
        Itt j√°t√©kos kv√≠zk√©rd√©seken kereszt√ºl tanulhatod meg a hivatalos floorball
        szab√°lyokat magyarul, gyorsan √©s f√°jdalommentesen. (Ok√©, a Game Over n√©ha f√°j egy kicsit.)
      </p>

      <div class="welcome-box welcome-box-highlight">
        <p class="welcome-text">
          <strong>Hogyan m≈±k√∂dik?</strong><br />
          V√°lassz t√©mak√∂rt, ut√°na szintet (L1‚ÄìL3),
          √©s pr√≥b√°lj meg min√©l t√∂bb k√©rd√©sre helyesen v√°laszolni, miel≈ëtt elfogynak az √©leteid.
        </p>
      </div>

      <div class="welcome-box">
        <p class="welcome-text">
          <strong>Tipp:</strong> ha valamiben bizonytalan vagy, n√©zd meg a hivatalos szab√°lyk√∂nyv PDF-et
          a k√∂nyv ikonra kattintva. A k√©rd√©sek alatt mindig jel√∂lj√ºk, hogy melyik paragrafushoz tartoznak.
        </p>
      </div>

      <button class="btn-main btn-main--accent" type="button" onclick="app.toggleWelcome()">
        Kezdj√ºk!
      </button>
    </div>
  </div>

  <!-- RESET MODAL -->
  <div class="modal-overlay" id="reset-modal">
    <div class="modal-box modal-box-center">
      <span class="welcome-emoji">üóëÔ∏è</span>
      <h2 class="modal-title">Biztos t√∂rl√∂d az el≈ërehalad√°st?</h2>
      <p class="welcome-text">
        Minden eddigi v√°lasz, streak √©s teljes√≠tett szint t√∂rl≈ëdik <strong>csak ezen az eszk√∂z√∂n</strong>.
        A d√∂nt√©st nem lehet visszavonni.
      </p>
      <div class="modal-actions">
        <button class="btn-main danger" type="button" onclick="app.fullReset()">
          Igen, mindent t√∂rl√∂k
        </button>
        <button class="btn-main btn-main--secondary" type="button" onclick="app.toggleResetModal()">
          M√©gsem
        </button>
      </div>
    </div>
  </div>

  <!-- INFO + GYIK MODAL -->
  <div class="modal-overlay" id="info-modal">
    <div class="modal-box">
      <div class="modal-header">
        <h2 class="modal-title">Inf√≥ & GYIK</h2>
        <button class="icon-btn modal-close" type="button" onclick="app.toggleInfo()">
          <i class="ph-x"></i>
        </button>
      </div>

      <div class="alert-box success">
        <h3>Mi ez az app?</h3>
        <p>
          Egy hobbi-projekt, amely seg√≠t a magyar floorball k√∂z√∂ss√©gnek
          (j√°t√©kosok, edz≈ëk, b√≠r√≥k) a szab√°lyok gyakorl√°s√°ban.
          Nem hivatalos IFF alkalmaz√°s, de a k√©rd√©sek a hivatalos szab√°lyk√∂nyvre √©p√ºlnek.
        </p>
      </div>

      <h3 class="modal-subtitle">Hogyan haszn√°ld?</h3>
      <ul class="info-list">
        <li><strong>1.</strong> V√°laszd ki a t√©mak√∂rt (pl. J√°t√©kt√©r, B√ºntet√©sek).</li>
        <li><strong>2.</strong> V√°lassz szintet: L1 = alap, L2 = halad√≥, L3 = kem√©ny di√≥.</li>
        <li><strong>3.</strong> V√°laszolj a k√©rd√©sekre ‚Äì minden rossz v√°lasz egy √©letet visz.</li>
        <li><strong>4.</strong> A k√©rd√©s alatt magyar√°zatot √©s szab√°lyk√∂nyv hivatkoz√°st kapsz.</li>
        <li><strong>5.</strong> Ha mindent v√©gigj√°tszott√°l, megkapod a ‚ÄûFloorball Mester‚Äù jelv√©nyt.</li>
      </ul>

      <h3 class="modal-subtitle">GYIK</h3>

      <details>
        <summary>A k√©rd√©sek hivatalos forr√°sb√≥l sz√°rmaznak?</summary>
        <p>
          A k√©rd√©sek a hivatalos magyar ford√≠t√°s√∫ szab√°lyk√∂nyv (2022) sz√∂veg√©re √©p√ºlnek.
          A projekt azonban <strong>nem hivatalos</strong>, oktat√°si c√©l√∫ kezdem√©nyez√©s.
        </p>
      </details>

      <details>
        <summary>Mi az a ‚Äûstreak‚Äù a fejl√©cben?</summary>
        <p>
          A streak azt mutatja, h√°ny k√©rd√©sre v√°laszolt√°l egym√°s ut√°n helyesen.
          Ha hib√°zol, a sz√°ml√°l√≥ lenull√°z√≥dik ‚Äì ide√°lis √∂nsz√≠vat√≥ funkci√≥ edz√©sekre. üòÑ
        </p>
      </details>

      <details>
        <summary>Mit jelent a P√°rbaj kih√≠v√°s (b√©ta)?</summary>
        <p>
          Megh√≠vhatsz egy m√°sik j√°t√©kost egy gyors p√°rbajra. Ugyanazokat a k√©rd√©seket kapj√°tok,
          az nyer, aki el≈ëbb hib√°zik (vagy kevesebbet ront). A m√≥d jelenleg k√≠s√©rleti jelleg≈±.
        </p>
      </details>

      <details>
        <summary>Melyik eszk√∂z√∂n l√°tom az el≈ërehalad√°somat?</summary>
        <p>
          Minden eredm√©ny <strong>helyben</strong>, a b√∂ng√©sz≈ëdben t√°rol√≥dik.
          Ha m√°sik telefonr√≥l vagy g√©pr≈ël l√©psz be, ott null√°r√≥l indul a j√°t√©k.
        </p>
      </details>

      <h3 class="modal-subtitle">Adatkezel√©s r√∂viden</h3>
      <p class="info-paragraph-top">
        Az alkalmaz√°s nem k√©r bejelentkez√©st, nevet, e-mail c√≠met.
        A halad√°sod √©s be√°ll√≠t√°said <strong>localStorage-ben</strong> t√°rol√≥dnak a k√©sz√ºl√©keden.
      </p>
      <ul class="info-list info-list-compact">
        <li>A k√©rd√©s-v√°lasz eredm√©nyek szem√©lyhez nem k√∂thet≈ëk.</li>
        <li>
          Az Umami analitika anonim m√≥don m√©ri, hogy h√°nyan haszn√°lj√°k az oldalt
          (pl. h√°ny t√©mak√∂rt nyitnak meg, mennyi id≈ët t√∂ltenek itt).
        </li>
        <li>Ha mindent t√∂r√∂lni szeretn√©l, haszn√°ld a kuka ikont a fejl√©cben.</li>
      </ul>
    </div>
  </div>

  <!-- iOS TELEP√çT√âSI √öTMUTAT√ì -->
  <div class="modal-overlay" id="ios-install-modal">
    <div class="modal-box modal-box-center">
      <h2 class="modal-title">Telep√≠t√©s iOS-re</h2>
      <p class="welcome-text">
        iPhone-on √©s iPaden nyisd meg az oldalt Safariban, majd v√°laszd a
        <strong>Megoszt√°s &raquo; Hozz√°ad√°s a F≈ëk√©perny≈ëh√∂z</strong> men√ºpontot.
        Ezut√°n √∫gy haszn√°lhatod, mintha nat√≠v app lenne.
      </p>
      <div class="modal-actions">
        <button class="btn-main btn-main--accent" type="button" onclick="app.closeIosInstall()">
          √ârtettem
        </button>
      </div>
    </div>
  </div>

  <!-- MULTIPLAYER: HOST MODAL (LINK MEGOSZT√ÅS) -->
  <div class="modal-overlay" id="host-modal">
    <div class="modal-box modal-box-center">
      <h2 class="modal-title">P√°rbaj link megoszt√°sa</h2>
      <p class="welcome-text">
        M√°sold ki a linket, √©s k√ºldd el az ellenfelednek. Ha csatlakozik,
        automatikusan indul a p√°rbaj.
      </p>

      <input
        id="share-link-input"
        type="text"
        readonly
        style="width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(0,0,0,0.08); margin:12px 0;" />

      <div class="modal-actions">
        <button class="btn-main btn-main--accent" type="button" onclick="app.shareLink()">
          Link m√°sol√°sa / megoszt√°sa
        </button>
        <button class="btn-main btn-main--secondary" type="button" onclick="app.cancelHost()">
          M√©gsem
        </button>
      </div>
    </div>
  </div>

  <!-- MULTIPLAYER: GUEST MODAL (KIH√çV√ÅS ELFOGAD√ÅSA) -->
  <div class="modal-overlay" id="challenge-modal">
    <div class="modal-box modal-box-center">
      <h2 class="modal-title">P√°rbaj kih√≠v√°s</h2>
      <p class="welcome-text">
        Az ellenfeled p√°rbajra h√≠vott. Elfogadod a kih√≠v√°st?
      </p>
      <div class="modal-actions">
        <button class="btn-main btn-main--accent" type="button" onclick="app.acceptChallenge()">
          Igen, indulhat!
        </button>
        <button class="btn-main btn-main--secondary" type="button" onclick="app.rejectChallenge()">
          Nem most
        </button>
      </div>
    </div>
  </div>

  <!-- MULTIPLAYER: V√ÅRAKOZ√ÅS AZ ELLENF√âLRE -->
  <div class="modal-overlay" id="waiting-modal">
    <div class="modal-box modal-box-center">
      <h2 class="modal-title">V√°rakoz√°s az ellenf√©lre‚Ä¶</h2>
      <p class="welcome-text">
        Te m√°r v√°laszolt√°l erre a k√©rd√©sre. V√°runk az ellenf√©l v√°lasz√°ra vagy id≈ët√∫ll√©p√©s√©re.
      </p>
      <div class="loader-spinner"></div>
    </div>
  </div>
</body>
</html>

