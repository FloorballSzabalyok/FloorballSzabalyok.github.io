<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>FloorballSzab√°lyok</title>

  <!-- PWA / ikonok (ha m√°r megvannak) -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="img/icon-192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="img/icon-512.png">
  <meta name="theme-color" content="#FF5E62">

  <!-- Poppins bet≈±t√≠pus -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- Phosphor ikonok (header ikon gombokhoz) -->
  <link rel="stylesheet"
        href="https://unpkg.com/@phosphor-icons/web@2.1.1/src/regular/style.css">

  <!-- F≈ë st√≠luslap ‚Äì EZT A F√ÅJLT HOZD L√âTRE: styles.css -->
  <link rel="stylesheet" href="styles.css">

  <!-- Umami analitika ‚Äì IDE √çRD BE A SAJ√ÅT ID-DAT -->
  <!-- <script async src="https://cloud.umami.is/script.js" data-website-id="c1fb486e-d928-445e-986d-fa44cc181fae"></script> -->
</head>
<body>
<div class="app-container">

  <!-- FEJL√âC / DASHBOARD -->
  <header class="dashboard-header">
    <div class="dashboard-nav">
      <!-- Home gomb ‚Äì mindig visszavisz a f≈ëmen√ºre -->
      <button class="icon-btn" type="button" aria-label="F≈ëmen√º" onclick="app.menu()">
        <i class="ph ph-house"></i>
      </button>

      <!-- c√≠m (kattinthat√≥: vissza f≈ëmen√ºre) -->
      <div class="app-title" onclick="app.menu()">
        Floorball Mester v11.0
      </div>

      <div class="header-actions">
        <!-- Inf√≥ + GYIK -->
        <button class="icon-btn" type="button" aria-label="Inf√≥ √©s GYIK" onclick="app.toggleInfo()">
          <i class="ph ph-info"></i>
        </button>

        <!-- Szab√°lyk√∂nyv -->
        <button class="icon-btn" type="button" aria-label="Szab√°lyk√∂nyv" onclick="app.showRules()">
          <i class="ph ph-book-open-text"></i>
        </button>

        <!-- Teljes reset -->
        <button class="icon-btn" type="button" aria-label="Eredm√©nyek t√∂rl√©se"
                onclick="app.toggleResetModal()">
          <i class="ph ph-trash"></i>
        </button>

        <!-- T√©ma v√°lt√≥ -->
        <button class="icon-btn" type="button" aria-label="Vil√°gos / s√∂t√©t m√≥d" onclick="app.toggleTheme()">
          <i id="theme-icon" class="ph ph-moon"></i>
        </button>
      </div>
    </div>

    <!-- √ñsszes√≠tett statisztik√°k -->
    <div class="dashboard-stats-container">
      <div class="stat-pill">
        <div class="stat-label">Megoldott k√©rd√©sek</div>
        <div class="stat-data">
          <span id="stat-answered">0</span>
          <span class="stat-sep">/</span>
          <span id="stat-total">0</span>
        </div>
      </div>
      <div class="stat-pill">
        <div class="stat-label">Zsin√≥rban helyes</div>
        <div class="stat-data">
          <span id="stat-streak">0</span>
        </div>
      </div>
    </div>
  </header>

  <!-- F≈ê TARTALOM -->
  <main class="content">

    <!-- F≈êMEN√ú / T√âMA LISTA -->
    <section id="s-menu" class="screen screen-menu active">
      <div class="section-header">
        <h2>T√©mak√∂r√∂k</h2>
        <div class="section-total-badge">
          <span id="total-badge">0%</span>
        </div>
      </div>

      <div class="section-progress">
        <div class="progress-track">
          <div class="progress-fill" id="total-progress-fill"></div>
        </div>
      </div>

      <!-- P√ÅRBAJ CTA ‚Äì T√âMAK√ÅRTY√ÅK FELETT -->
      <div class="dashboard-cta">
        <button class="btn-main btn-main--accent btn-main--compact"
                type="button"
                onclick="app.startChallengeMode()">
          üéÆ Floorball p√°rbaj ind√≠t√°sa
        </button>
      </div>

      <!-- T√âMAK√ÅRTY√ÅK -->
      <div class="topic-list" id="topic-container"></div>
    </section>

    <!-- SZINTV√ÅLASZT√ì -->
    <section id="s-levels" class="screen">
      <h2>Szint v√°laszt√°s</h2>
      <div id="lvl-title" class="level-title">T√©mak√∂r c√≠me</div>
      <p class="level-subtitle">
        V√°laszd ki, mennyire akarod sz√≠vni magad: Kezd≈ë (L1), Halad√≥ (L2) vagy Profi (L3).
      </p>
      <div id="level-container"></div>
    </section>

    <!-- GAME SCREEN -->
    <section id="s-game" class="screen">
      <div class="game-header">
        <div id="multi-badge"
             style="display:none; font-size:0.75rem; text-transform:uppercase; letter-spacing:1px; font-weight:800; color:var(--secondary); margin-bottom:6px;">
          P√°rbaj m√≥d
        </div>

        <div id="round-indicator"
             class="game-subtitle"
             style="display:none; margin-bottom:6px;">
          K√∂r: 1 / 10
        </div>

        <div id="g-lives"></div>

        <div class="game-subtitle">
          <span id="q-label">H√°tral√©v≈ë k√©rd√©sek:</span>
          <span class="game-subtitle-number" id="q-remaining">0</span>
        </div>

        <div class="game-progress">
          <div class="progress-track">
            <div class="progress-fill" id="g-prog"></div>
          </div>
        </div>

        <!-- Id≈ëz√≠t≈ë csak p√°rbaj m√≥dban l√°tszik -->
        <div class="timer-track" id="timer-bar" style="display:none;">
          <div class="timer-fill" id="timer-fill"></div>
        </div>
      </div>

      <div class="q-box">
        <div id="q-text">K√©rd√©s sz√∂vege‚Ä¶</div>
      </div>

      <div id="g-opts"></div>
      <div id="g-feed" class="feedback"></div>

      <div class="bottom-spacer"></div>
    </section>

    <!-- END SCREEN -->
    <section id="s-end" class="screen screen-end">
      <div class="end-icon" id="end-icon">üéâ</div>
      <h1 class="end-title" id="end-title">K√∂r v√©ge</h1>
      <p class="end-msg" id="end-msg">Sz√©p munka! Csak √≠gy tov√°bb!</p>

      <div class="end-card">
        <div class="end-card-label">Eredm√©nyed</div>
        <div class="end-score" id="end-score">0/0</div>
      </div>

      <div class="end-actions" id="end-actions">
        <!-- gombok JS-b≈ël -->
      </div>
    </section>

    <!-- MESTER CERTIFIK√ÅTUM -->
    <section id="s-master" class="screen screen-master">
      <div id="certificate" class="certificate-box">
        <div class="certificate-icon">üèÜ</div>
        <div class="certificate-title">Floorball Mester</div>
        <p class="certificate-text">
          Gratul√°lok! V√©gigtoltad az √∂sszes t√©mak√∂rt √©s szintet.  
          Ha ezt kinyomtatod √©s kirakod a falra, a b√≠r√≥ is megijed t≈ëled.
        </p>
        <div class="certificate-badge">
          Hivatalosan is szab√°lyguru lett√©l
        </div>
      </div>

      <button class="btn-main btn-main--accent"
              type="button"
              onclick="app.downloadCert()">
        üéì Tan√∫s√≠tv√°ny let√∂lt√©se k√©pk√©nt
      </button>
    </section>

    <!-- SZAB√ÅLYK√ñNYV N√âZET (MOBIL) -->
    <section id="s-rules" class="screen screen-rules">
      <div class="rules-header">
        <h2>Hivatalos szab√°lyk√∂nyv</h2>
      </div>

      <div class="pdf-mobile-view">
        <div class="pdf-deco-icon">üìò</div>
        <div class="pdf-title-mobile">Floorball ‚Äì J√°t√©kszab√°lyok 2022</div>
        <p style="margin-bottom: 20px; font-size:0.9rem;">
          A PDF a legt√∂bb telefonon k√ºl√∂n n√©zetben ny√≠lik meg (be√©p√≠tett olvas√≥val).
          Haszn√°ld b√°tran a keres≈ët (üîç), ha konkr√©t szab√°lyt keresel.
        </p>
        <a href="Floorball_Jatekszabalyok_2022_FINAL.pdf"
           class="btn-pdf"
           target="_blank" rel="noopener">
          PDF megnyit√°sa
          <span>‚Üó</span>
        </a>
      </div>

      <!-- Biztons√°g kedv√©√©rt be√°gyazott n√©zet is (tablet / nagy mobil) -->
      <iframe class="pdf-desktop-view"
              src="Floorball_Jatekszabalyok_2022_FINAL.pdf"></iframe>
    </section>

  </main>
</div>

<!-- WELCOME MODAL ‚Äì HUMOROS KEZD≈ê POPUP -->
<div class="modal-overlay" id="welcome-modal">
  <div class="modal-box modal-box-center">
    <span class="welcome-emoji">ü•Ö</span>
    <h1 class="welcome-title">√údv a Floorball Mesterben!</h1>
    <p class="welcome-text">
      Ez egy rajong√≥i k√©sz√≠t√©s≈±, ingyenes gyakorl√≥ app a
      <strong>hivatalos floorball szab√°lyok</strong> elsaj√°t√≠t√°s√°hoz.
      R√∂vid k√©rd√©sek, vicces visszajelz√©sek, nulla magol√°s.
    </p>

    <div class="welcome-box welcome-box-highlight">
      <p class="welcome-text">
        üí° Tipp: kezdd az L1 szintekkel, azt√°n l√©pj tov√°bb L2 √©s L3-ra.
        A k√©rd√©sek KLP-alap√∫ak, √≠gy id≈ëvel az eg√©sz szab√°lyk√∂nyv √∂ssze√°ll a fejedben.
      </p>
    </div>

    <div class="welcome-box">
      <p class="welcome-text">
        ‚ö†Ô∏è Fontos: ez nem hivatalos IFF alkalmaz√°s.
        A m√©rvad√≥ mindig a <strong>hivatalos PDF szab√°lyk√∂nyv</strong>.
      </p>
    </div>

    <div class="modal-actions">
      <button class="btn-main btn-main--accent" type="button" onclick="app.toggleWelcome()">
        √ârtem, kezdj√ºk!
      </button>
    </div>
  </div>
</div>

<!-- INFO + GYIK MODAL -->
<div class="modal-overlay" id="info-modal">
  <div class="modal-box">
    <div class="modal-header">
      <h2 class="modal-title">Inf√≥ &amp; GYIK</h2>
      <button class="icon-btn modal-close" type="button" onclick="app.toggleInfo()">
        <i class="ph ph-x"></i>
      </button>
    </div>

    <p class="info-strong-lead">
      Ez az app a magyar floorball k√∂z√∂ss√©gnek k√©sz√ºlt:
      <strong>j√°t√©kosoknak, b√≠r√≥knak, edz≈ëknek</strong>, akik nem csak √©rz√©sb≈ël,
      hanem szab√°lyk√∂nyvb≈ël is szeretn√©nek j√°tszani. üòÑ
    </p>

    <h3 class="info-highlight-title">Hogyan m≈±k√∂dik?</h3>
    <ul class="info-list">
      <li>Minden t√©mak√∂r (T01‚ÄìT07) az IFF 2022-es szab√°lyk√∂nyv√©n alapul.</li>
      <li>A k√©rd√©sek KLP (kulcstanul√°si pont) szerint vannak fel√©p√≠tve.</li>
      <li>L1 = alapfogalmak, L2 = tipikus szitu√°ci√≥k, L3 = ‚Äúb√≠r√≥i agy‚Äù szint.</li>
    </ul>

    <h3 class="info-highlight-title">GYIK</h3>

    <details>
      <summary>Hivatalos-e az alkalmaz√°s?</summary>
      <p>
        Nem. Ez egy rajong√≥i, non-profit oktat√≥ eszk√∂z.
        A hivatalos szab√°lyok√©rt mindig a PDF szab√°lyk√∂nyvet kell n√©zni.
      </p>
    </details>

    <details>
      <summary>Mib≈ël dolgoznak a k√©rd√©sek?</summary>
      <p>
        A k√©rd√©sek az IFF 2022-es j√°t√©kszab√°lyain √©s a magyar ford√≠t√°son alapulnak.
        A k√©rd√©sek mellett <strong>szab√°lyk√∂nyv hivatkoz√°st</strong> is tal√°lsz
        (pl. 501/1), hogy gyorsan vissza tudd keresni az eredeti sz√∂veget.
      </p>
    </details>

    <details>
      <summary>Mit jelent az L1‚ÄìL2‚ÄìL3 szint?</summary>
      <p>
        L1 ‚Äì alapfogalmak, defin√≠ci√≥k, egyszer≈± d√∂nt√©sek.<br>
        L2 ‚Äì tipikus, meccsen gyakran el≈ëfordul√≥ szitu√°ci√≥k.<br>
        L3 ‚Äì tr√ºkk√∂s, vit√°s, b√≠r√≥i gondolkod√°st ig√©nyl≈ë esetek.
      </p>
    </details>

    <details>
      <summary>Mi az a p√°rbaj m√≥d?</summary>
      <p>
        K√©t j√°t√©kos val√≥s id≈ëben m√©ri √∂ssze a szab√°lyismeret√©t.
        Ugyanazokat a k√©rd√©seket kapj√°tok, az nyer, aki el≈ëbb hib√°zik a m√°sikhoz k√©pest.
      </p>
    </details>

    <h3 class="info-highlight-title">Adatkezel√©s &amp; technika</h3>
    <ul class="info-list info-list-compact">
      <li>
        <strong>Ment√©s:</strong> az el≈ërehalad√°sod a b√∂ng√©sz≈ëd
        <code>localStorage</code>-√©ben t√°rol√≥dik, nem ker√ºl szerverre.
      </li>
      <li>
        <strong>Umami analitika:</strong> n√©vtelen√ºl m√©rem,
        mely t√©mak√∂r√∂ket √©s men√ºpontokat haszn√°lj√°k a legt√∂bben
        (pl. h√°nyan nyitj√°k meg a szab√°lyk√∂nyvet, mennyi single session indul).
      </li>
      <li>
        <strong>Firebase Realtime Database:</strong> csak a p√°rbaj m√≥dhoz haszn√°lom,
        ott ideiglenesen t√°rol√≥dik a szoba azonos√≠t√≥ja √©s a k√∂r√∂k √°llapota.
        Nincs user-fi√≥k, nincs e-mail, nincs n√©v.
      </li>
      <li>
        <strong>GitHub Pages:</strong> innen t√∂lt≈ëdik be maga az oldal (statikus hosting).
      </li>
    </ul>

    <p class="info-paragraph-top" style="font-size:0.85rem; color:var(--text-muted);">
      Ha b√°rmilyen tartalmi hib√°t tal√°lsz a k√©rd√©sekben vagy hivatkoz√°sokban,
      jelezd k√©rlek a fejleszt≈ënek ‚Äì a c√©l, hogy a magyar floorball k√∂z√∂ss√©gnek
      legyen egy <strong>j√°t√©kos, de szakmailag pontos</strong> eszk√∂ze.
    </p>
  </div>
</div>

<!-- RESET MODAL -->
<div class="modal-overlay" id="reset-modal">
  <div class="modal-box modal-box-center">
    <div class="modal-header">
      <h2 class="modal-title">Eredm√©nyek t√∂rl√©se</h2>
      <button class="icon-btn modal-close" type="button" onclick="app.toggleResetModal()">
        <i class="ph ph-x"></i>
      </button>
    </div>

    <p>Biztosan t√∂rl√∂d az √∂sszes helyes v√°laszt, streaket √©s be√°ll√≠t√°st?</p>

    <div class="modal-actions">
      <button class="btn-main btn-main--secondary" type="button" onclick="app.toggleResetModal()">
        M√©gsem
      </button>
      <button class="btn-main btn-main danger" type="button" onclick="app.fullReset()">
        Igen, mindent t√∂rl√∂k
      </button>
    </div>
  </div>
</div>

<!-- iOS PWA TELEP√çT√âS TIPPEK -->
<div class="modal-overlay" id="ios-install-modal">
  <div class="modal-box modal-box-center">
    <div class="modal-header">
      <h2 class="modal-title">Telep√≠t√©s iOS-en</h2>
      <button class="icon-btn modal-close" type="button" onclick="app.closeIosInstall()">
        <i class="ph ph-x"></i>
      </button>
    </div>
    <p>
      Safari-ban nyisd meg az oldalt, majd a megoszt√°s ikonra (‚¨ÜÔ∏è) nyomva v√°laszd:
      <strong>Hozz√°ad√°s a F≈ëk√©perny≈ëh√∂z</strong>.
    </p>
    <div class="modal-actions">
      <button class="btn-main btn-main--secondary" type="button" onclick="app.closeIosInstall()">
        Rendben
      </button>
    </div>
  </div>
</div>

<!-- HOST MODAL ‚Äì SZOB√ÅK L√âTREHOZ√ÅSA -->
<div class="modal-overlay" id="host-modal">
  <div class="modal-box modal-box-center">
    <div class="modal-header">
      <h2 class="modal-title">P√°rbaj szoba l√©trehozva</h2>
      <button class="icon-btn modal-close" type="button" onclick="app.cancelHost()">
        <i class="ph ph-x"></i>
      </button>
    </div>

    <p>Oszd meg az al√°bbi linket az ellenfeleddel:</p>

    <input id="share-link-input"
           type="text"
           readonly
           style="width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(0,0,0,0.1); margin:10px 0 12px 0; font-size:0.85rem;">

    <div class="modal-actions">
      <button class="btn-main btn-main--accent" type="button" onclick="app.shareLink()">
        Link m√°sol√°sa / megoszt√°sa
      </button>
      <button class="btn-main btn-main--secondary" type="button" onclick="app.cancelHost()">
        M√©gsem
      </button>
    </div>
  </div>
</div>

<!-- GUEST MODAL ‚Äì CSATLAKOZ√ÅS SZOB√ÅHOZ -->
<div class="modal-overlay" id="challenge-modal">
  <div class="modal-box modal-box-center">
    <div class="modal-header">
      <h2 class="modal-title">P√°rbaj megh√≠v√≥</h2>
      <button class="icon-btn modal-close" type="button" onclick="app.rejectChallenge()">
        <i class="ph ph-x"></i>
      </button>
    </div>

    <p>Az ellenfeled kih√≠vott egy floorball szab√°lyp√°rbajra. Elfogadod?</p>

    <div class="modal-actions">
      <button class="btn-main btn-main--accent" type="button" onclick="app.acceptChallenge()">
        Igen, csatlakozom
      </button>
      <button class="btn-main btn-main--secondary" type="button" onclick="app.rejectChallenge()">
        Most nem
      </button>
    </div>
  </div>
</div>

<!-- V√ÅRAKOZ√ÅS MODAL ‚Äì P√ÅRBAJ K√ñZBEN -->
<div class="modal-overlay" id="waiting-modal">
  <div class="modal-box modal-box-center">
    <h2 class="modal-title">V√°rakoz√°s az ellenf√©lre‚Ä¶</h2>
    <p style="margin-bottom: 10px;">
      Te m√°r v√°laszolt√°l erre a k√©rd√©sre.  
      V√°rjuk, hogy az ellenf√©l is befejezze a k√∂rt.
    </p>
    <div class="loader-spinner"></div>
    <p style="font-size:0.8rem; color:var(--text-muted);">
      Ha t√∫l sok√°ig nem v√°laszol, a p√°rbaj technikai okb√≥l megszakadhat.
    </p>
  </div>
</div>

<!-- REMATCH ‚Äì √öJ P√ÅRBAJ K√âR√âS MODAL (AZ ELLENF√âLNEK) -->
<div class="modal-overlay" id="rematch-request-modal">
  <div class="modal-box modal-box-center">
    <div class="modal-header">
      <h2 class="modal-title">√öj p√°rbaj?</h2>
      <button class="icon-btn modal-close" type="button" onclick="app.rejectRematch()">
        <i class="ph ph-x"></i>
      </button>
    </div>
    <p>Az ellenfeled √∫j p√°rbajt szeretne ugyanebben a szob√°ban.</p>
    <div class="modal-actions">
      <button class="btn-main btn-main--accent" type="button" onclick="app.acceptRematch()">
        Elfogadom az √∫j p√°rbajt
      </button>
      <button class="btn-main btn-main--secondary" type="button" onclick="app.rejectRematch()">
        Most ink√°bb gyakorlok
      </button>
    </div>
  </div>
</div>

<!-- REMATCH ‚Äì V√ÅRAKOZ√ÅS MODAL (AKI K√âRTE) -->
<div class="modal-overlay" id="rematch-waiting-modal">
  <div class="modal-box modal-box-center">
    <h2 class="modal-title">√öj p√°rbaj k√©r√©se elk√ºldve</h2>
    <p>V√°rjuk, hogy a m√°sik j√°t√©kos elfogadja vagy elutas√≠tsa a k√©r√©st.</p>
    <div class="loader-spinner"></div>
  </div>
</div>

<!-- REMATCH ‚Äì ELUTAS√çT√ÅS INF√ì MODAL -->
<div class="modal-overlay" id="rematch-info-modal">
  <div class="modal-box modal-box-center">
    <h2 class="modal-title">P√°rbaj elutas√≠tva</h2>
    <p>
      A m√°sik j√°t√©kos elutas√≠totta az √∫j p√°rbajt.  
      Menj vissza gyakorolni, √©s legk√∂zelebb lepip√°lod! üí™
    </p>
    <div class="modal-actions">
      <button class="btn-main btn-main--secondary" type="button" onclick="app.closeRematchInfo()">
        Rendben
      </button>
    </div>
  </div>
</div>

<!-- Telep√≠t√©s gomb (PWA) ‚Äì JS teszi l√°that√≥v√° -->
<button id="install-btn"
        class="btn-main btn-main--accent btn-pulse"
        style="position:fixed; right:16px; bottom:16px; left:16px; display:none; z-index:1500;"
        type="button"
        onclick="app.triggerInstall()">
  üì≤ Telep√≠t√©s a kezd≈ëk√©perny≈ëre
</button>

<!-- K√ºls≈ë script-ek a legv√©g√©n -->
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<!-- Firebase v8 ‚Äì csak a p√°rbaj m√≥dhoz kell -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<!-- F≈ë alkalmaz√°s logika ‚Äì EZT A F√ÅJLT HOZD L√âTRE: app.js -->
<script src="app.js"></script>
</body>
</html>
