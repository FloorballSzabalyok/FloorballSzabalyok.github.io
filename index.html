<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>FloorballSzab√°lyok</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#FFFFFF">

  <script defer src="https://unpkg.com/@phosphor-icons/web"></script>
  <script defer src="https://cloud.umami.is/script.js" data-website-id="c1fb486e-d928-445e-986d-fa44cc181fae"></script>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

</head>

<body>

<noscript>
  <div style="padding: 16px; text-align:center; color: #c53030; background:#FFF5F5;">
    Ez az alkalmaz√°s JavaScript n√©lk√ºl nem m≈±k√∂dik. K√©rlek enged√©lyezd a JavaScriptet a b√∂ng√©sz≈ëdben.
  </div>
</noscript>

<div class="app-container">

  <div class="dashboard-header">
    <div class="dashboard-nav">
      <button class="icon-btn" onclick="app.menu()" aria-label="F≈ëmen√º" title="F≈ëmen√º">
        <i class="ph-bold ph-house"></i>
      </button>
      <div class="app-title" onclick="app.menu()">FloorballSzab√°lyok</div>
      <div class="header-actions">
        <button class="icon-btn" id="install-btn" onclick="app.triggerInstall()" style="display: none;" aria-label="Telep√≠t√©s" title="Telep√≠t√©s">
          <i class="ph-bold ph-download-simple"></i>
        </button>
        <button class="icon-btn" id="theme-btn" onclick="app.toggleTheme()" aria-label="T√©ma v√°lt√°sa" title="T√©ma v√°lt√°sa">
          <i id="theme-icon" class="ph-bold ph-moon"></i>
        </button>
        <button class="icon-btn" onclick="app.showRules()" aria-label="Szab√°lyk√∂nyv" title="Szab√°lyk√∂nyv">
          <i class="ph-bold ph-book-open-text"></i>
        </button>
        <button class="icon-btn" onclick="app.toggleInfo()" aria-label="Inform√°ci√≥k" title="Inform√°ci√≥k">
          <i class="ph-bold ph-info"></i>
        </button>
        <button class="icon-btn" onclick="app.toggleResetModal()" aria-label="Adatok t√∂rl√©se" title="Adatok t√∂rl√©se">
          <i class="ph-bold ph-trash"></i>
        </button>
      </div>
    </div>
    <div class="dashboard-stats-container">
      <div class="stat-pill">
        <span class="stat-label">V√°laszok</span>
        <span class="stat-data">
          <span id="stat-answered">0</span><span class="stat-sep">/</span><span id="stat-total">0</span>
        </span>
      </div>
      <div class="stat-pill">
        <span class="stat-label">Streak</span>
        <span class="stat-data highlight">
          <span id="stat-streak">0</span> <i class="ph-fill ph-fire" style="color: #ff9f43;"></i>
        </span>
      </div>
    </div>
  </div>

  <!-- MULTIPLAYER MODALOK -->

  <div id="challenge-modal" class="modal-overlay">
    <div class="modal-box modal-box-center" role="dialog" aria-modal="true" aria-labelledby="challenge-title">
      <h2 class="welcome-title" id="challenge-title">‚öîÔ∏è P√°rbajra h√≠vtak!</h2>
      <div class="welcome-box">
        <span class="welcome-emoji">ü•ä</span>
        <p class="welcome-text">
          Valaki kih√≠vott egy val√≥s idej≈± p√°rbajra.<br>
          <strong>Szab√°ly:</strong> Vegyes k√©rd√©sek. Aki el≈ësz√∂r ront, vesz√≠t!
        </p>
      </div>
      <div class="modal-actions">
        <button class="btn-main" onclick="app.acceptChallenge()">Elfogadom! üöÄ</button>
        <button class="btn-main secondary" onclick="app.rejectChallenge()">Nem most</button>
      </div>
    </div>
  </div>

  <div id="host-modal" class="modal-overlay">
    <div class="modal-box modal-box-center" role="dialog" aria-modal="true" aria-labelledby="host-title">
      <h2 class="welcome-title" id="host-title">Ellenf√©lre v√°runk...</h2>
      <div class="welcome-box">
        <div class="loader-spinner"></div>
        <p class="welcome-text" style="margin-top:15px;">K√ºldd el ezt a linket a bar√°todnak:</p>
        <input
          type="text"
          id="share-link-input"
          readonly
          onclick="this.select()"
          style="width:100%; padding:12px; margin:10px 0; border-radius:12px; border:1px solid var(--text-muted); background:var(--bg); color:var(--text-main); text-align:center;"
          aria-label="Megoszt√°si link"
        >
      </div>
      <div class="modal-actions">
        <button class="btn-main btn-main--accent" onclick="app.shareLink()">üîó Link M√°sol√°sa</button>
        <button class="btn-main secondary" onclick="app.cancelHost()">M√©gse</button>
      </div>
    </div>
  </div>

  <div id="waiting-modal" class="modal-overlay">
    <div class="modal-box modal-box-center" role="dialog" aria-modal="true" aria-labelledby="waiting-title">
      <div class="loader-spinner"></div>
      <h3 id="waiting-title" style="margin-top:20px;">V√°rakoz√°s az ellenf√©lre...</h3>
      <p style="color:var(--text-muted);">Te m√°r v√°laszolt√°l. Most a m√°sikon a sor.</p>
    </div>
  </div>

  <!-- INFO MODAL -->

    <div id="info-modal" class="modal-overlay" onclick="app.toggleInfo()">
    <div class="modal-box" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">Inform√°ci√≥k</h2>
        <button class="icon-btn modal-close" type="button" onclick="app.toggleInfo()">√ó</button>
      </div>

      <!-- FIGYELEM -->
      <div class="alert-box warning">
        <h3>‚ö†Ô∏è Figyelem!</h3>
        <p>
          Ez egy <strong>hobbi projekt</strong>. Hivatalos m√©rk≈ëz√©seken mindig az aktu√°lis
          <strong>IFF Szab√°lyk√∂nyv</strong> az ir√°nyad√≥.
        </p>
        <p class="info-paragraph-top">
          A j√°t√©k seg√≠t a szab√°lyok gyakorl√°s√°ban, de <strong>nem helyettes√≠ti</strong> a hivatalos
          j√°t√©kvezet≈ëi k√©pz√©st vagy vizsg√°t.
        </p>
      </div>

      <!-- R√ñVID ADATKEZEL√âS -->
      <div class="alert-box success">
        <h3>üõ°Ô∏è Adatkezel√©s ‚Äì r√∂viden</h3>
        <p>
          Az egy√©ni eredm√©nyek kiz√°r√≥lag ezen az eszk√∂z√∂n, a b√∂ng√©sz≈ë
          <strong>localStorage</strong> ter√ºlet√©n t√°rol√≥dnak.
        </p>
        <p class="info-paragraph-top">
          A P√°rbaj szob√°k ideiglenes, v√©letlenszer≈± szobak√≥ddal j√∂nnek l√©tre a Firebase-ben.
          A j√°t√©k v√©g√©n a rendszer megpr√≥b√°lja automatikusan t√∂r√∂lni ezeket.
        </p>
      </div>

      <!-- J√ÅT√âKM√ìDOK -->
      <div class="modal-subtitle">J√°t√©km√≥dok</div>

      <details>
        <summary>üéÆ Egy√©ni gyakorl√°s</summary>
        <p>
          Klasszikus ‚Äûegy j√°t√©kos‚Äù m√≥d, ahol t√©mak√∂r√∂nk√©nt haladsz v√©gig
          a k√©rd√©seken.
        </p>
        <ul class="info-list-compact">
          <li>Minden szinten <strong>3 √©lettel</strong> indulsz.</li>
          <li>Ha elfogy az √∂sszes √©let, v√©ge a k√∂rnek.</li>
          <li>L1 ‚Üí L2 ‚Üí L3 sorrend k√∂telez≈ë, magasabb szint csak az el≈ëz≈ë teljes√≠t√©se ut√°n ny√≠lik meg.</li>
          <li>A badge-ek (kis kup√°k) mutatj√°k, hogy melyik szint(ek)et vitted v√©gig.</li>
          <li>Ha mindh√°rom szint k√©sz minden t√©m√°ban, megkapod a ‚ÄûFloorball Mester‚Äù oklevelet.</li>
        </ul>
      </details>

      <details>
        <summary>‚öîÔ∏è P√°rbaj m√≥d (B√âTA)</summary>
        <p>
          Val√≥s idej≈±, k√∂r√∂kre osztott p√°rbaj vegyes k√©rd√©sekkel.
          Aki el≈ësz√∂r hib√°zik, <strong>kiesik</strong>.
        </p>
        <ul class="info-list-compact">
          <li>Csak internetkapcsolattal m≈±k√∂dik (Firebase).</li>
          <li>Host hozza l√©tre a szob√°t, √©s linkkel h√≠vja meg az ellenfelet.</li>
          <li>Mindk√©t j√°t√©kos ugyanazt a k√©rd√©st l√°tja, azonos v√°laszlehet≈ës√©gekkel.</li>
          <li>V√°laszid≈ë: k√∂r√∂nk√©nt <strong>kb. 30 m√°sodperc</strong>. Id≈ët√∫ll√©p√©s = hib√°s v√°lasz.</li>
          <li>Ha mindketten hib√°tlanok maradnak a maxim√°lis k√∂rsz√°mig, a j√°t√©k d√∂ntetlen.</li>
          <li>Ha valaki kil√©p vagy elvesz√≠ti a kapcsolatot, a rendszer technikai d√∂ntetlennel z√°rhatja a p√°rbajt.</li>
        </ul>
      </details>

      <!-- ADATV√âDELEM & GDPR -->
      <div class="modal-subtitle">Adatv√©delem &amp; GDPR</div>

      <details>
        <summary>üìä Milyen adatot t√°rol az app?</summary>
        <ul class="info-list-compact">
          <li>
            Nem k√©r nevet, e-mail c√≠met vagy k√ºl√∂n felhaszn√°l√≥i fi√≥kot.
          </li>
          <li>
            Helyben t√°rolt adatok: t√©mak√∂r√∂nk√©nti el≈ërehalad√°s, szintenk√©nti k√©rd√©ssz√°m,
            streak, t√©ma/szint be√°ll√≠t√°sok, v√°lasztott t√©ma (vil√°gos / s√∂t√©t m√≥d).
          </li>
          <li>
            Ezek b√°rmikor t√∂r√∂lhet≈ëk a jobb fels≈ë sarokban l√©v≈ë
            <strong>kuka</strong> ikonra kattintva.
          </li>
        </ul>
      </details>

      <details>
        <summary>‚òÅÔ∏è K√ºls≈ë szolg√°ltat√≥k (Umami, Firebase)</summary>
        <ul class="info-list-compact">
          <li>
            Az oldal <strong>Umami</strong> analitik√°t haszn√°l anonim l√°togatotts√°gi statisztik√°hoz
            (pl. melyik k√©perny≈ët h√°nyszor nyitj√°k meg).
          </li>
          <li>
            A <strong>Firebase Realtime Database</strong> a P√°rbaj m√≥d szob√°it kezeli
            v√©letlenszer≈± szobak√≥d alapj√°n.
          </li>
          <li>
            Ezek szolg√°ltat√≥k technikai okokb√≥l (pl. biztons√°g, hibakeres√©s) r√∂vid ideig
            napl√≥zhatj√°k az IP-c√≠met √©s b√∂ng√©sz≈ëadatokat, de a fejleszt≈ë ezeket
            egyedileg azonos√≠that√≥ form√°ban nem haszn√°lja fel.
          </li>
        </ul>
      </details>

      <details>
        <summary>üßπ Hogyan tudod t√∂r√∂lni az adataidat?</summary>
        <ul class="info-list-compact">
          <li>
            Az appon bel√ºl: jobb fels≈ë sarok &rarr; <strong>kuka ikon</strong> &rarr; ‚ÄûIgen, t√∂rl√©s‚Äù.
          </li>
          <li>
            A b√∂ng√©sz≈ë be√°ll√≠t√°saiban k√ºl√∂n is t√∂r√∂lheted a webhely adatait / s√ºtijeit,
            ami minden helyi ment√©st (localStorage) megsz√ºntet.
          </li>
        </ul>
      </details>

      <button class="btn-main" onclick="app.toggleInfo()">Bez√°r√°s</button>
    </div>
  </div>


  <!-- RESET MODAL -->

    <div id="reset-modal" class="modal-overlay" onclick="app.toggleResetModal()">
    <div class="modal-box" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">T√∂rl√©s</h2>
        <button class="icon-btn modal-close" type="button" onclick="app.toggleResetModal()">√ó</button>
      </div>

      <div class="alert-box warning">
        <h3>Biztosan t√∂rl√∂d az adatokat?</h3>
        <p>A j√°t√©k teljesen el√∂lr≈ël indul <strong>csak ezen az eszk√∂z√∂n / b√∂ng√©sz≈ëben</strong>.</p>
        <ul class="info-list-compact">
          <li>T√∂rl≈ëdik minden eddigi v√°lasz, sz√°zal√©k, badge √©s a streak.</li>
          <li>Elt≈±nik a ‚ÄûFloorball Mester‚Äù oklev√©l, ha m√°r megszerezted.</li>
          <li>Vissza√°llnak az app-be√°ll√≠t√°sok (pl. vil√°gos / s√∂t√©t t√©ma, √ºdv√∂zl≈ë popup).</li>
        </ul>
        <p class="info-paragraph-top">
          A k√ºls≈ë szolg√°ltat√≥k (Umami, Firebase) √°ltal kezelt <em>technikai napl√≥kat</em> ez a gomb nem t√∂rli,
          de ezek nem tartalmaznak nevet vagy fi√≥khoz k√∂thet≈ë adatot.
        </p>
      </div>

      <div class="modal-actions">
        <button class="btn-main danger" onclick="app.fullReset()">Igen, t√∂rl√©s</button>
        <button class="btn-main secondary" onclick="app.toggleResetModal()">M√©gse</button>
      </div>
    </div>
  </div>


  <!-- WELCOME MODAL -->

    <div id="welcome-modal" class="modal-overlay">
    <div class="modal-box modal-box-center">
      <h2 class="welcome-title">√údv a p√°ly√°n! üëã</h2>

      <div class="welcome-box">
        <span class="welcome-emoji">ü§îü•Ö</span>
        <p class="welcome-text">
          Folyamatosan ki√°ll√≠tanak? Vakarod a fejed egy b√≠r√≥i d√∂nt√©sn√©l?<br>
          <strong>Ideje gyakorolni!</strong>
        </p>
      </div>

      <div class="welcome-box welcome-box-highlight">
        <span class="welcome-emoji">üó£Ô∏è</span>
        <p class="welcome-text">
            B√≠r√≥ vagy? V√°laszolj meg minden k√©rd√©st, legy√©l pro √©s <strong>a sz√ºleid nem fognak annyit csuklani</strong> egy-egy meccs alatt.
        </p>
      </div>
      <button class="btn-main" onclick="app.toggleWelcome()">Gyer√ºnk!</button>
    </div>
  </div>


  <!-- iOS INSTALL MODAL -->

  <div id="ios-install-modal" class="modal-overlay" onclick="app.closeIosInstall()">
    <div
      class="modal-box modal-box-center"
      onclick="event.stopPropagation()"
      role="dialog"
      aria-modal="true"
      aria-labelledby="ios-install-title"
    >
      <div class="modal-header">
        <h2 class="modal-title" id="ios-install-title">Telep√≠t√©s iPhone-ra</h2>
        <button
          class="icon-btn modal-close"
          onclick="app.closeIosInstall()"
          aria-label="Bez√°r√°s"
          title="Bez√°r√°s"
        >
          √ó
        </button>
      </div>
      <div class="alert-box success">
        <p>Telep√≠tsd az appot a jobb √©lm√©ny√©rt!</p>
      </div>
      <button class="btn-main" onclick="app.closeIosInstall()">√ârtem</button>
    </div>
  </div>

  <!-- F≈êMEN√ú -->

  <div id="s-menu" class="screen active content">
    <div class="section-header">
      <h2>T√©mak√∂r√∂k</h2>
      <div class="section-total-badge" id="total-badge">0%</div>
    </div>
    
    <button class="btn-main btn-main--accent btn-spacing-bottom" onclick="app.startChallengeMode()">
      ‚öîÔ∏è P√°rbaj Kih√≠v√°s (B√©ta)
    </button>

    <div class="progress-track section-progress">
      <div id="total-progress-fill" class="progress-fill"></div>
    </div>
    <div id="master-info" class="master-badge">
      <span class="master-icon">üèÜ</span>
      <span class="master-text">El√©rted a <strong>Floorball Mester</strong> szintet!</span>
    </div>
    <div id="topic-container" class="topic-list">
      <div style="text-align:center;">Bet√∂lt√©s...</div>
    </div>
  </div>

  <!-- SZAB√ÅLYK√ñNYV K√âPERNY≈ê -->

  <div id="s-rules" class="screen content screen-rules">
    <div class="rules-header">
      <h1 class="level-title">Szab√°lyk√∂nyv</h1>
      <p class="level-subtitle">Hivatalos IFF dokumentum</p>
    </div>
    <div class="pdf-mobile-view">
      <i class="ph-duotone ph-book-open-text pdf-deco-icon"></i>
      <div class="pdf-title-mobile">A teljes szab√°lyzat elolvas√°s√°hoz nyisd meg a PDF-et.</div>
      <a href="Floorball_Jatekszabalyok_2022_FINAL.pdf" target="_blank" class="btn-pdf" rel="noopener noreferrer">
        <i class="ph-bold ph-file-pdf"></i> Megnyit√°s / Let√∂lt√©s
      </a>
    </div>
    <iframe
      class="pdf-desktop-view"
      src="Floorball_Jatekszabalyok_2022_FINAL.pdf"
      title="Floorball szab√°lyk√∂nyv PDF"
    ></iframe>
    <div style="padding: 20px; text-align:center; flex-shrink: 0;">
      <button class="btn-main secondary" onclick="app.menu()">Vissza a men√ºbe</button>
    </div>
  </div>

  <!-- SZINTV√ÅLASZT√ì -->

  <div id="s-levels" class="screen content">
    <h1 id="lvl-title" class="level-title">...</h1>
    <div id="level-container"></div>
    <button class="btn-main secondary" onclick="app.menu()">Vissza</button>
  </div>

  <!-- J√ÅT√âK K√âPERNY≈ê -->

  <div id="s-game" class="screen content">
    <div class="game-header">
      <div id="timer-bar" class="timer-track" style="display:none;">
        <div id="timer-fill" class="timer-fill"></div>
      </div>
      
      <div id="multi-badge" class="game-subtitle" style="display:none; color:var(--primary); margin-bottom:5px;">
        ‚öîÔ∏è P√ÅRBAJ M√ìD
      </div>

      <div class="lives" id="g-lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
      <div class="game-subtitle">
        <span id="round-indicator" style="display:none;"></span>
        <span id="q-label">H√°tral√©v≈ë:</span>
        <span id="q-remaining" class="game-subtitle-number">0</span>
      </div>
      <div class="progress-track game-progress">
        <div id="g-prog" class="progress-fill"></div>
      </div>
    </div>
    <div class="q-box" id="q-text">...</div>
    <div class="opts" id="g-opts"></div>
    <div id="g-feed" class="feedback"></div>
    <div class="bottom-spacer"></div>
  </div>

  <!-- V√âGE K√âPERNY≈ê -->

  <div id="s-end" class="screen content screen-end">
    <div id="end-icon" class="end-icon">üèÅ</div>
    <h1 id="end-title" class="end-title">V√©ge</h1>
    <p id="end-msg" class="end-msg">...</p>
    <div class="end-card">
      <div id="end-score" class="end-score">0</div>
    </div>
    <div id="end-actions" class="end-actions"></div>
  </div>

  <!-- MESTER OKLEV√âL -->

  <div id="s-master" class="screen content screen-master">
    <div id="certificate" class="certificate-box">
      <div class="certificate-icon">üèÜ</div>
      <h1 class="certificate-title">GRATUL√ÅLUNK!</h1>
      <div class="certificate-badge">FLOORBALL MESTER</div>
    </div>
    <button class="btn-main btn-spacing-bottom" onclick="app.downloadCert()">Ment√©s</button>
    <button class="btn-main secondary" onclick="app.menu()">Bez√°r√°s</button>
  </div>

</div>

<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => navigator.serviceWorker.register('sw.js'));
  }
</script>
<script src="app.js"></script>
</body>
</html>
